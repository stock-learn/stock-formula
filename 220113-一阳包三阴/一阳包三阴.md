# 一阳包三阴

点击 [这里](./一阳包三阴-案例.md) 查看案例回测记录。

## 1. 修订历史

| 版本 |    日期    | 备注
|:----:|:----------:|:----:
| 1.0  | 2022-01-13 | 单参 N
| 1.1  | 2022-01-20 | 三参 N、D、Y

> 公式起源： 300572-安车检测（220106~220110）

## 2. 胜率特点

- 一阳振幅>=9%
- 20 日均线向上或趋平 - 中期非下降趋势
- 三阴被一阳高低点包住（包含线）
- 三阴高低点连续创新低
- 三阴低点跌倒一阳低点附近（如正负偏差在0.5%内）
- 三阴对一阳为连续缩量跌
- MACD 在零轴之上且无死叉

提高胜率因素：

- MA20 趋势向上
- MA5 未明显拐头向下或依然保持趋势向上

## 3. 操盘策略

- 进场策略： 
    1. 三阴收盘前5分钟
    2. 第二天突破三阴高点
- 止损策略： 一阳和三阴的低点
- 止盈策略： 
    1. 一阳高点
    2. 突破任一左侧 K 线高点后折返
- 强制离场策略： 
    1. 三阴收盘介入后第二天没有反包成功
    2. 介入后两天不涨

## 4. 选股公式

参数:

1. N：一阳距当前的周期数，`[3,100]`，默认 3，用于当日尾盘进场，设置为大于 3 的值用于回测。
2. D：阴调低点与一阳低点之间距离允许的偏差百分比乘以 100，`[0, 5]`，默认 0.5。
3. Y：大阳振幅乘以 100，`[6, 40]`，默认 9。

```
{N日前大阳，振幅>=Y%}
DY:=(REF(H,N)-REF(L,N))/REF(C,N+1)>=0.09;

{大阳后阴调 3 天，高点低点均不断降低，阴调低点接近大阳低点(+-0.5%)}
YT:=LAST(CLOSE<OPEN,N-1,N-3)
   {高点不断降低}
   AND LAST(REF(H,1)>H,N-2,N-3)
   {低点不断降低}
   AND LAST(REF(L,1)>L,N-2,N-3)
   {阴调高点在大阳高点下}
   AND REF(H,N-1) <= REF(H,N)
   {阴调低点接近大阳低点}
   AND REF(L,N-3)/REF(L,N)<=1+D/100
   AND REF(L,N-3)/REF(L,N)>=1-D/100;

{MA20向上或趋平（允许向下-0.1%）}
T1:=MA(REF(C,N-3),20)/MA(REF(C,N),20);
MA20ND:=T1>=1 OR T1>=0.999;

{N-1~N-3为连续缩量}
SL:=LAST(V<=REF(V,1),N-1,N-3);

{C1. 基本型}
C1:=DY AND YT AND MA20ND;

{C2. C1叠加连续缩量}
C2:=C1 AND SL;

C2;
```